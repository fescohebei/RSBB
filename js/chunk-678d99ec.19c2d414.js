(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-678d99ec"],{"7bfd":function(e,a,t){},"8cd2":function(e,a,t){"use strict";var r=t("7bfd"),o=t.n(r);o.a},ac5f:function(e,a,t){"use strict";t.r(a);var r=function(){var e=this,a=e.$createElement,t=e._self._c||a;return t("a-drawer",{attrs:{title:"上传工资表",visible:this.visible.show,width:550,destroyOnClose:!0},on:{close:e.onClose}},[t("a-spin",{attrs:{tip:"上传中",spinning:e.spinning}},[t("a-form",{attrs:{form:e.form}},[t("a-form-item",{attrs:{label:"批次名称","label-col":{span:4},"wrapper-col":{span:12}}},[t("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["ColName",e.AFormImportRules.ColName],expression:"['ColName',AFormImportRules.ColName]"}]})],1),t("a-form-item",{attrs:{label:"发放月份","label-col":{span:4},"wrapper-col":{span:12}}},[t("a-month-picker",{directives:[{name:"decorator",rawName:"v-decorator",value:["NianYue",e.AFormImportRules.NianYue],expression:"['NianYue',AFormImportRules.NianYue]"}]})],1),t("a-form-item",[t("a-upload-dragger",{attrs:{name:"file",multiple:!1,action:"/api/Salary/Payroll/UploadPayroll",accept:".xls, .xlsx",showUploadList:!1,withCredentials:!0,beforeUpload:e.uploadbefore,data:e.FormImportData},on:{change:e.uploadchange}},[t("p",{staticClass:"ant-upload-drag-icon"},[t("a-icon",{attrs:{type:"inbox"}})],1),t("p",{staticClass:"ant-upload-text"},[e._v("\n            将文件拖到此处，或\n            "),t("a-tag",{attrs:{color:"#2db7f5"}},[e._v("点击上传")])],1),t("p",{staticClass:"ant-upload-hint"},[e._v("只能上传xls/xlsx文件")])])],1)],1)],1),t("a-card",{staticClass:"markdown",attrs:{title:"注意事项"}},[t("ul",[t("li",[t("a",{attrs:{href:"/template/工资明细表模板.xlsx"}},[e._v("下载《工资明细模板》")])]),t("li",[e._v("列顺序可调整，表格必须包含标黄列")]),t("li",[e._v("请从第四行填写数据，姓名、身份证号列必须有值，且身份证号是真实的身份证号")]),t("li",[e._v("数据必须放在第一个Sheet表")]),t("li",[e._v("一个月可多次上传工资明细，批次名称不能重复，同一人将合并计税")])])]),e.errdatarows.length>0?[t("a-divider",{attrs:{orientation:"left"}},[e._v("不规范数据")]),t("a-table",{attrs:{dataSource:e.errdatarows,columns:e.columns,bordered:!1,size:"middle",rowKey:e.rowKey},scopedSlots:e._u([{key:"err",fn:function(a){return[t("a-tag",{attrs:{color:"red"}},[e._v(e._s(a.错误原因))])]}}],null,!1,3464628469)})]:e._e()],2)},o=[],s=[{title:"姓名",dataIndex:"姓名"},{title:"身份证号",dataIndex:"身份证号"},{title:"错误原因",scopedSlots:{customRender:"err"}}],i={props:{show:{type:Object,default:{show:!1}},refresh:{type:Function,default:null}},data:function(){return{spinning:!1,form:this.$form.createForm(this),visible:{show:!1},FormImportData:{Nian:"",Yue:"",ColName:""},columns:s,AFormImportRules:{ColName:{rules:[{required:!0,message:"请输入批次名称"}]},NianYue:{rules:[{required:!0,message:"请选择工资发放月份"}]}},errdatarows:[]}},created:function(){var e=this;this.$watch("show",function(a,t){e.visible=a,e.spinning=!1})},methods:{rowKey:function(e){return e.PayrollGuid},onClose:function(){this.visible.show=!1,this.FormImportData={Nian:"",Yue:"",ColName:""},this.errdatarows=[],this.refresh&&this.refresh()},uploadbefore:function(e){var a=this,t=!1;return this.form.validateFields(function(e,r){t=!e,t&&(a.FormImportData={Nian:r.NianYue.format("YYYY"),Yue:r.NianYue.format("MM"),ColName:r.ColName},a.spinning=!0)}),t},uploadchange:function(e){var a=e.file;e.fileList,e.event;if("done"==a.status){var t=a.response;console.log(t),t.code>0?(this.$message.error(t.msg),t.data&&(this.errdatarows=t.data)):(this.$message.success("导入成功"),this.onClose())}this.spinning=!1}}},n=i,l=(t("8cd2"),t("2877")),u=Object(l["a"])(n,r,o,!1,null,null,null);a["default"]=u.exports}}]);