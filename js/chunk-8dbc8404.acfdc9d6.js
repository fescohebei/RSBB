(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-8dbc8404","chunk-678d99ec","chunk-4f73a587","chunk-2d0e1a13"],{"289c":function(t,e,a){"use strict";var r=a("e3f1"),o=a.n(r);o.a},"7af9":function(t,e,a){"use strict";a.r(e);var r=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("a-drawer",{attrs:{visible:this.visible.show,width:450,destroyOnClose:!0,closable:!1,title:"多批次工资表"},on:{close:t.onClose}},[a("a-table",{attrs:{columns:t.columns,dataSource:t.dataSource,bordered:!1,size:"middle",rowKey:t.rowKey}})],1)},o=[],l=[{title:"批次",dataIndex:"BatchName"},{title:"年",dataIndex:"PayrollYear"},{title:"月",dataIndex:"PayrollMonth"}],n={props:{show:{type:Object,default:{show:!1}}},data:function(){return{visible:{show:!1},columns:l,dataSource:[]}},created:function(){var t=this;this.$watch("show",function(e,a){t.visible=e,t.dataSource=e.record})},methods:{onClose:function(){this.visible.show=!1,this.dataSource=[]},rowKey:function(t){return t.PayrollColGuid}}},s=n,i=a("2877"),c=Object(i["a"])(s,r,o,!1,null,null,null);e["default"]=c.exports},"7bfd":function(t,e,a){},"8cd2":function(t,e,a){"use strict";var r=a("7bfd"),o=a.n(r);o.a},9444:function(t,e,a){"use strict";a.r(e);var r=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("a-drawer",{attrs:{visible:this.visible.show,width:750,destroyOnClose:!0,closable:!1},on:{close:t.onClose}},[a("template",{slot:"title"},[t._v("\n    "+t._s(t.title)+"\n    "),a("a-button",{staticStyle:{float:"right","margin-right":"5px",color:"#409EFF"},attrs:{size:"small",icon:"cloud-download"},on:{click:t.btnExport}},[t._v("导出")]),t.record.Confirm?t._e():a("a-button",{staticStyle:{float:"right","margin-right":"5px",color:"red"},attrs:{size:"small",icon:"delete"},on:{click:t.btnDelete}},[t._v("删除")]),t.record.Confirm?t._e():a("a-button",{staticStyle:{float:"right","margin-right":"5px",color:"green"},attrs:{size:"small",icon:"check-square"},on:{click:t.btnConfirm}},[t._v("确认")])],1),a("a-row",{staticStyle:{padding:"8px 0"},attrs:{gutter:10}},[a("a-col",{staticStyle:{"text-align":"right"},attrs:{span:4}},[t._v("导入时间:")]),a("a-col",{attrs:{span:6}},[t._v(t._s(t.record.ImportDate))]),a("a-col",{staticStyle:{"text-align":"right"},attrs:{span:4}},[t._v("批次名称:")]),a("a-col",{attrs:{span:6}},[t._v(t._s(t.record.BatchName))])],1),a("a-row",{staticStyle:{padding:"8px 0"},attrs:{gutter:10}},[a("a-col",{staticStyle:{"text-align":"right"},attrs:{span:4}},[t._v("发放月:")]),a("a-col",{attrs:{span:6}},[t._v(t._s(t.record.PayrollYear)+"年"+t._s(t.record.PayrollMonth)+"月")]),a("a-col",{staticStyle:{"text-align":"right"},attrs:{span:4}},[t._v("状态:")]),a("a-col",{attrs:{span:6}},[t._v(t._s(t.record.Confirm?"已确认":"未确认"))])],1),a("a-divider",{attrs:{orientation:"left"}},[t._v("员工列表")]),a("a-table",{attrs:{columns:t.columns,dataSource:t.dataSource,bordered:!1,pagination:!0,size:"middle",rowKey:t.rowKey}}),a("drawer-delerr",{attrs:{show:t.drawer.delerr}})],2)},o=[],l=a("b775"),n=a("7af9"),s=[{title:"姓名",dataIndex:"PName"},{title:"身份证号",dataIndex:"IDCard"},{title:"累计专项",dataIndex:"累计专项扣除"},{title:"累计专项附加",dataIndex:"累计专项附加扣除"},{title:"累计已扣税额",dataIndex:"累计已预扣预缴税额"},{title:"本月应缴税额",dataIndex:"本期应预扣预缴税额"}],i={components:{DrawerDelerr:n["default"]},props:{show:{type:Object,default:{show:!1}},title:{type:String,default:""},refresh:{type:Function,default:null}},data:function(){return{visible:{show:!1},record:{},columns:s,dataSource:[],drawer:{delerr:{show:!1,record:null}}}},created:function(){var t=this;this.$watch("show",function(e,a){t.visible=e,t.record=e.record,t.init()})},methods:{onClose:function(){this.visible.show=!1,this.refresh&&this.refresh()},btnExport:function(){var t=this,e=document.createElement("a");e.href="/api/Salary/Payroll/ExportPayroll?PayrollColGuid="+t.show.record.PayrollColGuid,e.click()},btnDelete:function(){var t=this;l["a"].post("/api/Salary/Payroll/DeletePayroll",{PayrollColGuid:t.show.record.PayrollColGuid}).then(function(e){var a=e;0===a.code?a.data.length>0?t.drawer.delerr={show:!0,record:a.data}:(t.onClose(),t.$message.success("已删除")):t.$message.error(a.msg)}).catch(function(e){t.$message.error("网络异常"),console.log(e)})},btnConfirm:function(){var t=this;l["a"].post("/api/Salary/Payroll/ConfirmPayroll",{PayrollColGuid:t.show.record.PayrollColGuid}).then(function(e){var a=e;0===a.code?(t.record.Confirm=!0,t.$message.success("已确认")):t.$message.error(a.msg)}).catch(function(e){t.$message.error("网络异常"),console.log(e)})},init:function(){var t=this;l["a"].post("/api/Salary/Payroll/PayrollDetail",{PayrollColGuid:t.show.record.PayrollColGuid}).then(function(e){var a=e;0===a.code&&(t.dataSource=a.data)}).catch(function(t){console.log(t)})},rowKey:function(t){return t.PayrollGuid}}},c=i,d=a("2877"),u=Object(d["a"])(c,r,o,!1,null,null,null);e["default"]=u.exports},ac5f:function(t,e,a){"use strict";a.r(e);var r=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("a-drawer",{attrs:{title:"上传工资表",visible:this.visible.show,width:550,destroyOnClose:!0},on:{close:t.onClose}},[a("a-spin",{attrs:{tip:"上传中",spinning:t.spinning}},[a("a-form",{attrs:{form:t.form}},[a("a-form-item",{attrs:{label:"批次名称","label-col":{span:4},"wrapper-col":{span:12}}},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["ColName",t.AFormImportRules.ColName],expression:"['ColName',AFormImportRules.ColName]"}]})],1),a("a-form-item",{attrs:{label:"发放月份","label-col":{span:4},"wrapper-col":{span:12}}},[a("a-month-picker",{directives:[{name:"decorator",rawName:"v-decorator",value:["NianYue",t.AFormImportRules.NianYue],expression:"['NianYue',AFormImportRules.NianYue]"}]})],1),a("a-form-item",[a("a-upload-dragger",{attrs:{name:"file",multiple:!1,action:"/api/Salary/Payroll/UploadPayroll",accept:".xls, .xlsx",showUploadList:!1,withCredentials:!0,beforeUpload:t.uploadbefore,data:t.FormImportData},on:{change:t.uploadchange}},[a("p",{staticClass:"ant-upload-drag-icon"},[a("a-icon",{attrs:{type:"inbox"}})],1),a("p",{staticClass:"ant-upload-text"},[t._v("\n            将文件拖到此处，或\n            "),a("a-tag",{attrs:{color:"#2db7f5"}},[t._v("点击上传")])],1),a("p",{staticClass:"ant-upload-hint"},[t._v("只能上传xls/xlsx文件")])])],1)],1)],1),a("a-card",{staticClass:"markdown",attrs:{title:"注意事项"}},[a("ul",[a("li",[a("a",{attrs:{href:"/template/工资明细表模板.xlsx"}},[t._v("下载《工资明细模板》")])]),a("li",[t._v("列顺序可调整，表格必须包含标黄列")]),a("li",[t._v("请从第四行填写数据，姓名、身份证号列必须有值，且身份证号是真实的身份证号")]),a("li",[t._v("数据必须放在第一个Sheet表")]),a("li",[t._v("一个月可多次上传工资明细，批次名称不能重复，同一人将合并计税")])])]),t.errdatarows.length>0?[a("a-divider",{attrs:{orientation:"left"}},[t._v("不规范数据")]),a("a-table",{attrs:{dataSource:t.errdatarows,columns:t.columns,bordered:!1,size:"middle",rowKey:t.rowKey},scopedSlots:t._u([{key:"err",fn:function(e){return[a("a-tag",{attrs:{color:"red"}},[t._v(t._s(e.错误原因))])]}}],null,!1,3464628469)})]:t._e()],2)},o=[],l=[{title:"姓名",dataIndex:"姓名"},{title:"身份证号",dataIndex:"身份证号"},{title:"错误原因",scopedSlots:{customRender:"err"}}],n={props:{show:{type:Object,default:{show:!1}},refresh:{type:Function,default:null}},data:function(){return{spinning:!1,form:this.$form.createForm(this),visible:{show:!1},FormImportData:{Nian:"",Yue:"",ColName:""},columns:l,AFormImportRules:{ColName:{rules:[{required:!0,message:"请输入批次名称"}]},NianYue:{rules:[{required:!0,message:"请选择工资发放月份"}]}},errdatarows:[]}},created:function(){var t=this;this.$watch("show",function(e,a){t.visible=e,t.spinning=!1})},methods:{rowKey:function(t){return t.PayrollGuid},onClose:function(){this.visible.show=!1,this.FormImportData={Nian:"",Yue:"",ColName:""},this.errdatarows=[],this.refresh&&this.refresh()},uploadbefore:function(t){var e=this,a=!1;return this.form.validateFields(function(t,r){a=!t,a&&(e.FormImportData={Nian:r.NianYue.format("YYYY"),Yue:r.NianYue.format("MM"),ColName:r.ColName},e.spinning=!0)}),a},uploadchange:function(t){var e=t.file;t.fileList,t.event;if("done"==e.status){var a=e.response;console.log(a),a.code>0?(this.$message.error(a.msg),a.data&&(this.errdatarows=a.data)):(this.$message.success("导入成功"),this.onClose())}this.spinning=!1}}},s=n,i=(a("8cd2"),a("2877")),c=Object(i["a"])(s,r,o,!1,null,null,null);e["default"]=c.exports},b64c:function(t,e,a){"use strict";a.r(e);var r=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("a-layout",[a("a-layout-content",[a("a-card",{attrs:{bordered:!1}},[a("a-form",{attrs:{layout:"horizontal"}},[a("div",{class:"fold"},[a("a-row",{attrs:{gutter:10}},[a("a-col",{attrs:{md:8}},[a("a-form-item",{attrs:{label:"月份",labelCol:{span:5},wrapperCol:{span:18,offset:1}}},[a("a-month-picker",{attrs:{placeholder:"月份"},model:{value:t.formSearch.Date,callback:function(e){t.$set(t.formSearch,"Date",e)},expression:"formSearch.Date"}})],1)],1),a("a-col",{attrs:{md:8}},[a("a-form-item",{attrs:{label:"批次名称",labelCol:{span:5},wrapperCol:{span:18,offset:1}}},[a("a-input",{attrs:{placeholder:"请输入"},model:{value:t.formSearch.Keyword,callback:function(e){t.$set(t.formSearch,"Keyword",e)},expression:"formSearch.Keyword"}})],1)],1),a("a-col",{attrs:{span:8}},[a("a-form-item",[a("a-button",{attrs:{type:"primary"},on:{click:t.init}},[t._v("查询")]),a("a-button",{staticStyle:{"margin-left":"8px"},on:{click:t.btnReset}},[t._v("重置")]),a("a-button",{staticStyle:{"margin-left":"8px"},attrs:{icon:"cloud-upload"},on:{click:t.btnUpload}},[t._v("上传")])],1)],1)],1)],1)]),a("div",{staticClass:"alert"},[a("a-alert",{attrs:{type:"info","show-icon":!0}},[a("div",{attrs:{slot:"message"},slot:"message"},[t._v("\n              总共 \n              "),a("a",{staticStyle:{"font-weight":"600"}},[t._v(t._s(t.formSearch.total))]),t._v("\n               批次工资表\n            ")])])],1),a("a-table",{attrs:{columns:t.columns,dataSource:t.dataSource,pagination:!1,rowKey:t.rowKey},scopedSlots:t._u([{key:"NianYue",fn:function(e){return[t._v(t._s(e.PayrollYear)+"年"+t._s(e.PayrollMonth)+"月")]}},{key:"Status",fn:function(e){return[t._v(t._s(e.Confirm?"已确认":"未确认"))]}},{key:"Operation",fn:function(e){return[a("a-tag",{on:{click:function(a){return t.showdetail(e)}}},[t._v("详情")])]}}])},[a("template",{slot:"footer"},[a("a-pagination",{staticStyle:{float:"right"},attrs:{defaultCurrent:1,pageSize:t.formSearch.pageSize,total:t.formSearch.total,current:t.formSearch.current},on:{change:t.pagechange}})],1)],2)],1)],1),a("drawer-upload",{attrs:{show:t.drawer.upload,refresh:t.init}}),a("drawer-detail",{attrs:{show:t.drawer.detail,refresh:t.init,title:t.drawer.detail.title}})],1)},o=[],l=a("b775"),n=a("ac5f"),s=a("9444"),i=(a("1c46"),[{title:"发放月",scopedSlots:{customRender:"NianYue"}},{title:"批次名称",dataIndex:"BatchName"},{title:"导入时间",dataIndex:"ImportDate"},{title:"状态",scopedSlots:{customRender:"Status"}},{title:"操作",scopedSlots:{customRender:"Operation"}}]),c=[],d={components:{DrawerUpload:n["default"],DrawerDetail:s["default"]},data:function(){return{formSearch:{pageSize:10,current:1,total:0},ld:null,columns:i,dataSource:c,drawer:{upload:{show:!1},detail:{show:!1,record:null,title:""}}}},computed:{tableHeight:function(){return window.innerHeight-400},navHeight:function(){return console.log(window.innerHeight-146),window.innerHeight-146}},methods:{init:function(){this.pagechange(1)},pagechange:function(t){var e=this;e.formSearch.current=t,l["a"].post("/api/Salary/Payroll/InitForPayroll",e.formSearch).then(function(t){var a=t;0===a.code&&(e.dataSource=a.data,e.formSearch.total=a.count)}).catch(function(t){console.log(t)})},btnUpload:function(){this.drawer.upload={show:!0}},btnReset:function(){this.formSearch.Date=null,this.formSearch.Keyword=""},rowKey:function(t){return t.PayrollColGuid},showdetail:function(t){this.drawer.detail={show:!0,record:t,title:t.BatchName+t.PayrollYear+"年"+t.PayrollMonth+"月工资表"}}},mounted:function(){var t=this;t.init()}},u=d,h=(a("289c"),a("2877")),f=Object(h["a"])(u,r,o,!1,null,null,null);e["default"]=f.exports},e3f1:function(t,e,a){}}]);